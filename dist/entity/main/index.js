$(function(){"use strict";function t(t){window.wechat.share({imgUrl:t.picture,title:t.title+("pending"==t.status?"(审核中)":""),description:t.content});var e=$(".panel"),n=e.find(".ads");n.find(".ads-close").on("click",function(t){n.addClass("out")});var i=e.find(".tip");setTimeout(function(){n.addClass("out"),i.addClass("out")},3e3),$('<link rel="stylesheet"/>').attr("href","/page/"+t.Theme.code+"/css/style.css").appendTo("head"),$.get("/page/"+t.Theme.code+"/index.html",function(n){$('<script id="card-template" type="text/html"/>').html(n).appendTo($("body"));var a=0;t.Posts.forEach(function(t,e){t.id==o&&(a=e)}),t.Posts[0]&&(t.Posts[0].likeCount+=t.likeCount),e.append(template("entity-template",t));var s=new Swiper(".swiper-container",{effect:"cube",spaceBetween:10,preloadImages:!1,lazyLoading:!0,lazyLoadingInPrevNext:!0,lazyLoadingOnTransitionStart:!0,initialSlide:parseInt(window.location.hash.slice(1))||a,onClick:function(e,n){location.href="/post/"+t.Posts[e.activeIndex].id},onSlideChangeStart:function(t){i.addClass("out")}});e.find(".footer-bar .logo").on("click",function(){s.slideTo(0)})})}var e=location.pathname.split("/").slice(1)[1],n=location.href.match(/\?.*pid=([^&]*)/),o=n&&n[1];window.wechat.checkUser(!0,function(n){$.getJSON("/services/entity/"+e+n,function(e){"success"==e.status?t(e.data):console.error(e.data)})}),$(window).on("scroll",function(t){t.preventDefault()}).on("touchmove",function(t){t.preventDefault()}).on("mousemove","img",function(t){t.preventDefault()})});