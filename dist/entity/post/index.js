$(function(){"use strict";function t(t){"undefined"!=typeof wechat&&wechat.share({imgUrl:(location.origin+t.Entity.picture).replace(/.*http/g,"http"),title:t.Entity.title,description:t.Entity.content}),$('<link rel="stylesheet"/>').attr("href","/page/"+t.Entity.Theme.code+"/css/style.css").appendTo("head"),$.get("/page/"+t.Entity.Theme.code+"/index.html",function(n){$('<script id="card-template" type="text/html"/>').html(n).appendTo($("body")),$(".panel").append(template("post-template",t));{var i=$(".post-card-index");new Swiper(".swiper-container",{spaceBetween:10,preloadImages:!1,lazyLoading:!0,lazyLoadingInPrevNext:!0,lazyLoadingOnTransitionStart:!0,onSlideChangeStart:function(t){i.text(t.activeIndex+1+"/"+t.slides.length)}})}$(".footer-bar-back").on("click",function(){return location.href.match(/\?.*from=catalog/)?(history.back(),!1):void 0}),e(t)})}function e(t){var e=$(".post-like_count"),n=e.find("img"),i=e.find("span").text(t.likeCount),o=["/entity/post/img/icon-like.png","/entity/post/img/icon-like-active.png"],a=localStorage.getItem("LIKED_POSTS");a=a?a.split(","):[],a.indexOf(t.id)>-1?(e.addClass("active"),n.attr("src",o[1])):n.attr("src",o[0]),e.on("click",function(){var c=e.hasClass("active");$.get("/services/post/"+t.id+"/"+(c?"unlike":"like"),function(s){return"success"!=s.status?void console.error(s.data):(c?(t.likeCount--,a.splice(a.indexOf(t.id),1),n.attr("src",o[0])):(t.likeCount++,n.attr("src",o[1]),a.push(t.id)),e.toggleClass("active"),i.text(t.likeCount),void localStorage.setItem("LIKED_POSTS",a.join(",")))})})}var n=location.pathname.split("/").slice(1)[1];$.getJSON("/services/post/"+n,function(e){"success"==e.status?t(e.data):console.error(e.data)}),$(window).on("scroll",function(t){t.preventDefault()}).on("touchmove",function(t){t.preventDefault()}).on("mousemove","img",function(t){t.preventDefault()})});