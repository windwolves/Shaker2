$(function(){"use strict";function t(t){if("undefined"!=typeof window.wechat){var i=t.Cards[0].pictures[0]||t.Entity.picture,n=t.Cards[0]&&t.Cards[0].contents[0]||"稀客--带你离开现实表面的互动内容社区";window.wechat.share({imgUrl:(location.origin+i).replace(/.*http/g,"http"),title:t.Entity.title,description:n})}t.isCover&&(t.likeCount+=t.Entity.likeCount),$('<link rel="stylesheet"/>').attr("href","/page/"+t.Entity.Theme.code+"/css/style.css").appendTo("head"),$.get("/page/"+t.Entity.Theme.code+"/index.html",function(i){$('<script id="card-template" type="text/html"/>').html(i).appendTo($("body")),$(".panel").append(template("post-template",t));{var n=$(".post-card-index");new Swiper(".swiper-container",{preloadImages:!1,lazyLoading:!0,lazyLoadingInPrevNext:!0,lazyLoadingOnTransitionStart:!0,onSlideChangeStart:function(t){n.text(t.activeIndex+1+"/"+t.slides.length)}})}$(".footer-bar-back").on("click",function(){return location.href.match(/\?.*from=catalog/)?(history.back(),!1):void 0}),e(t)})}function e(t){var e=$(".post-like_count"),i=e.find("img"),n=e.find("span").text(t.likeCount),o=["/entity/post/img/icon-like.png","/entity/post/img/icon-like-active.png"],a=localStorage.getItem("LIKED_POSTS");a=a?a.split(","):[],a.indexOf(t.id)>-1?(e.addClass("active"),i.attr("src",o[1])):i.attr("src",o[0]),e.on("click",function(){var s=e.hasClass("active"),c="/services/post/"+t.id+"/"+(s?"unlike":"like");$.get(c,function(c){return"success"!=c.status?void console.error(c.data):(s?(t.likeCount--,a.splice(a.indexOf(t.id),1),i.attr("src",o[0])):(t.likeCount++,i.attr("src",o[1]),a.push(t.id)),e.toggleClass("active"),n.text(t.likeCount),void localStorage.setItem("LIKED_POSTS",a.join(",")))})})}var i=location.pathname.split("/").slice(1)[1];$.getJSON("/services/post/"+i,function(e){"success"==e.status?t(e.data):console.error(e.data)}),$(window).on("scroll",function(t){t.preventDefault()}).on("touchmove",function(t){t.preventDefault()}).on("mousemove","img",function(t){t.preventDefault()})});